

<div class="auth-container">
  <div class="auth-card">
    <div class="logo-container">
      <img src="assets/logoSorteo.jpg" alt="Logo Sorteo" class="logo" routerLink="/home" />
    </div>

    <!-- FORMULARIO DE LOGIN -->
    <form [formGroup]="loginForm" (ngSubmit)="onLogin()" *ngIf="isLogin">
      <h1>Inicia Sesi칩n</h1>

      <input type="email" pInputText placeholder="Correo" formControlName="email" />

      <p-password
        placeholder="Contrase침a"
        formControlName="password"
        [toggleMask]="true"
        [feedback]="false"
      />

      <a class="forgot-password" (click)="showRecoveryDialog()">쯆lvidaste tu contrase침a?</a>

      <button pButton type="submit" label="Ingresar" class="p-button-success w-full mt-2"></button>
      <p class="toggle-text">쯅o tienes una cuenta? <a (click)="toggle()">Reg칤strate</a></p>
    </form>

    <!-- FORMULARIO DE REGISTRO -->
    <form [formGroup]="registerForm" (ngSubmit)="onSignup()" *ngIf="!isLogin">
      <h1>Reg칤strate</h1>

      <input type="text" pInputText placeholder="Nombre" formControlName="name" />
      <input type="email" pInputText placeholder="Correo" formControlName="email" />

      <p-password
        placeholder="Contrase침a"
        formControlName="password"
        [toggleMask]="true"
        weakLabel="D칠bil"
        mediumLabel="Medio"
        strongLabel="Fuerte"
        promptLabel="Ingresa tu contrase침a"
      />

      <p-password
        placeholder="Confirmar Contrase침a"
        formControlName="confirmarPassword"
        [toggleMask]="true"
        [feedback]="false"
      />

      <p-inputMask
        mask="+54 9 99 9999-9999"
        placeholder="+54 9 -- -----"
        formControlName="telefono"
        [autoClear]="false"
        slotChar="_"
      ></p-inputMask>

      <button pButton type="submit" label="Registrarse" class="p-button-success w-full"></button>
      <p class="toggle-text">쯏a tienes una cuenta? <a (click)="toggle()">Iniciar sesi칩n</a></p>
    </form>
  </div>
</div>


<p-dialog
  header="Recuperar Contrase침a"
  [(visible)]="displayRecoveryDialog"
  [modal]="true"
  [style]="{ width: '90%', maxWidth: '500px' }"
  [draggable]="false"
  [resizable]="false"
>
  <form [formGroup]="recoveryForm" (ngSubmit)="onRecuperar()">
    <div class="p-fluid">
      <div class="field">
        <label for="emailRecovery" class="block font-bold mb-2">Correo Electr칩nico</label>
        <input
          id="emailRecovery"
          type="email"
          pInputText
          formControlName="email"
          placeholder="tu@email.com"
          class="w-full"
        />
        <small
          class="text-red-500"
          *ngIf="recoveryForm.get('email')?.invalid && (recoveryForm.get('email')?.dirty || recoveryForm.get('email')?.touched)"
        >
          Debes ingresar un correo electr칩nico v치lido.
        </small>
      </div>

      <p class="text-sm text-gray-600 mt-2">
        Se enviar치 un c칩digo de recuperaci칩n a tu correo electr칩nico.
      </p>
    </div>

    <div class="flex justify-content-end gap-2 mt-4">
      <button
        pButton
        type="button"
        label="Cancelar"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideRecoveryDialog()"
      ></button>
      <button
        pButton
        type="submit"
        label="Enviar C칩digo"
        icon="pi pi-send"
        class="p-button-primary"
        [disabled]="!recoveryForm.valid"
      ></button>
    </div>
  </form>
</p-dialog>

<!-- 游댠 DI츼LOGO 2: CAMBIAR CONTRASE칌A CON C칍DIGO -->
<p-dialog
  header="Cambiar Contrase침a"
  [(visible)]="displayChangePasswordDialog"
  [modal]="true"
  [style]="{ width: '90%', maxWidth: '500px' }"
  [draggable]="false"
  [resizable]="false"
>
  <form [formGroup]="changePasswordForm" (ngSubmit)="onChangePassword()">
    <div class="p-fluid">

      <!-- Email (readonly) -->
      <div class="field">
        <label for="emailChange" class="block font-bold mb-2">Correo Electr칩nico</label>
        <input
          id="emailChange"
          type="email"
          pInputText
          formControlName="email"
          class="w-full"
          readonly
        />
      </div>

      <!-- C칩digo de recuperaci칩n -->
      <div class="field">
        <label for="codigo" class="block font-bold mb-2">C칩digo de Recuperaci칩n</label>
        <input
          id="codigo"
          type="text"
          pInputText
          formControlName="codigo"
          placeholder="Ingresa el c칩digo recibido por correo"
          class="w-full"
        />
        <small
          class="text-red-500"
          *ngIf="changePasswordForm.get('codigo')?.invalid && (changePasswordForm.get('codigo')?.dirty || changePasswordForm.get('codigo')?.touched)"
        >
          El c칩digo es requerido.
        </small>
      </div>

      <!-- Nueva contrase침a -->
      <div class="field">
        <label for="nuevaPassword" class="block font-bold mb-2">Nueva Contrase침a</label>
        <p-password
          id="nuevaPassword"
          formControlName="nuevaPassword"
          placeholder="M칤nimo 6 caracteres"
          [toggleMask]="true"
          [feedback]="true"
          weakLabel="D칠bil"
          mediumLabel="Medio"
          strongLabel="Fuerte"
          class="w-full"
        />
        <small
          class="text-red-500"
          *ngIf="changePasswordForm.get('nuevaPassword')?.invalid && (changePasswordForm.get('nuevaPassword')?.dirty || changePasswordForm.get('nuevaPassword')?.touched)"
        >
          La contrase침a debe tener al menos 6 caracteres.
        </small>
      </div>

      <!-- Confirmar nueva contrase침a -->
      <div class="field">
        <label for="confirmarNuevaPassword" class="block font-bold mb-2">Confirmar Nueva Contrase침a</label>
        <p-password
          id="confirmarNuevaPassword"
          formControlName="confirmarNuevaPassword"
          placeholder="Confirma tu contrase침a"
          [toggleMask]="true"
          [feedback]="false"
          class="w-full"
        />
        <small
          class="text-red-500"
          *ngIf="changePasswordForm.get('confirmarNuevaPassword')?.invalid && (changePasswordForm.get('confirmarNuevaPassword')?.dirty || changePasswordForm.get('confirmarNuevaPassword')?.touched)"
        >
          Debes confirmar la contrase침a.
        </small>
      </div>

      <p class="text-sm text-gray-600 mt-2">
        <i class="pi pi-info-circle"></i> Revisa tu correo para obtener el c칩digo de recuperaci칩n.
      </p>
    </div>

    <div class="flex justify-content-end gap-2 mt-4">
      <button
        pButton
        type="button"
        label="Cancelar"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideChangePasswordDialog()"
      ></button>
      <button
        pButton
        type="submit"
        label="Cambiar Contrase침a"
        icon="pi pi-check"
        class="p-button-success"
        [disabled]="!changePasswordForm.valid"
      ></button>
    </div>
  </form>
</p-dialog>
